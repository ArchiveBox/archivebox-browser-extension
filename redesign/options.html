<!DOCTYPE html>
<html lang="en">
<head>
  <title>ArchiveBox Collector - Options</title>
  <meta charset="UTF-8">
  <link href="bootstrap.min.css" rel="stylesheet">
  <style>
    .list-group-item code {
      background-color: #fdfaff;
      padding: 3px 10px;
      font-size: 13px;
      border-radius: 4px;
      text-overflow: ellipsis;
      width: 96%;
      white-space: nowrap;
      display: inline-block;
      overflow: hidden;
      padding-left: 26px;
      border-radius: 10px 4px 4px 10px;
      margin-left: -26px;
      z-index: 200;
      position: relative;
    }
    .list-group-item img.favicon {
      vertical-align: 1px;
      margin-right: 4px; 
      width: 20px; height: 20px;
      border-radius: 50%;
      position: relative;
      z-index: 400;
    }
    .container-full {
      padding-left: 10px;
      padding-right: 10px;
    }
    body, html {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    input[type=search]::-webkit-search-cancel-button {
        -webkit-appearance: searchfield-cancel-button;
    }
    .col-lg-7 {
      padding-bottom: 0px;
      margin-bottom: 0px;
    }
    .nav-tabs {
      margin-bottom: 20px;
    }

    .form-text {
      font-size: 0.85em;
      color: #666;
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-left: 8px;
    }

    .status-success {
      background: #28a745;
    }

    .status-error {
      background: #dc3545;
    }

    .test-section {
      margin-top: 2rem;
      padding-top: 1rem;
      border-top: 1px solid #dee2e6;
    }

    .sync-status {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-left: 8px;
      vertical-align: middle;
    }

    .sync-status.status-success {
      background: #28a745;
    }

    .sync-status.status-error {
      background: #dc3545;
    }
  </style>
</head>
<body class="container-full py-4">
  <ul class="nav nav-tabs" id="optionsTabs" role="tablist">
    <li class="nav-item">
      <a class="nav-link active" id="urls-tab" data-bs-toggle="tab" href="#urls" role="tab">URLs</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="config-tab" data-bs-toggle="tab" href="#config" role="tab">Config</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="personas-tab" data-bs-toggle="tab" href="#personas" role="tab">Personas</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="import-tab" data-bs-toggle="tab" href="#import" role="tab">Import</a>
    </li>
  </ul>

  <div class="tab-content">
    <!-- URLs Tab (existing content) -->
    <div class="tab-pane fade show active" id="urls" role="tabpanel">
      <div class="row mt-4">
        <div class="col-md-10">
          <h2>ArchiveBox Saved URLs</h2>
          <div class="d-flex gap-2 mb-3">
            <input type="search" class="form-control" id="filterInput" placeholder="Filter entries...">
            <button class="btn btn-outline-secondary" id="downloadCsv">
              CSV
            </button>
            <button class="btn btn-outline-secondary" id="downloadJson">
              JSON
            </button>
            <button class="btn btn-outline-danger" id="deleteFiltered">
              DELETE
            </button>
            <button class="btn btn-outline-primary" id="syncFiltered">
              SYNC
            </button>
          </div>
          <div id="entriesList" class="list-group"></div>
        </div>
        
        <div class="col-md-2">
          <h2>All Tags</h2>
          <div id="tagsList" class="list-group"></div>
        </div>
      </div>
    </div>

    <!-- Config Tab -->
    <div class="tab-pane fade" id="config" role="tabpanel">
      <div class="row mt-4">
        <div class="col-md-8">
          <form id="configForm" class="needs-validation" novalidate>
            <div class="mb-3">
              <label for="archivebox_server_url" class="form-label"><b>üíæ ArchiveBox Server URL *</b></label>
              <div class="input-group">
                <input type="url" class="form-control" id="archivebox_server_url" 
                       placeholder="https://archivebox.example.com">
                <button type="button" id="loginServer" class="btn btn-outline-secondary">
                  ‚öôÔ∏è ADMIN
                </button>
                <button type="button" id="testServer" class="btn btn-outline-secondary">
                  TEST SERVER
                  <span class="status-indicator" id="serverStatus"></span>
                </button>
              </div>
              <div class="form-text">
                The base URL of your self-hosted archivebox server, e.g. http://localhost:8000
                <span id="serverStatusText" class="ms-2"></span>
              </div>
            </div>

            <div class="mb-3">
              <label for="archivebox_api_key" class="form-label"><b>üîê ArchiveBox API Key</b></label>
              <div class="input-group">
                <input type="text" class="form-control" id="archivebox_api_key" 
                       pattern="^[a-f0-9]{32}$"
                       placeholder="... abcexamplekey1234 ...">
                <button type="button" id="generateApiKey" class="btn btn-outline-secondary">
                  ‚ûï GENERATE
                </button>
                <button type="button" id="testApiKey" class="btn btn-outline-secondary">
                  TEST API KEY
                  <span class="status-indicator" id="apiKeyStatus"></span>
                </button>
              </div>
              <div class="form-text">
                ArchiveBox API key generated on your server (32 character lowercase hex string)
                <span id="apiKeyStatusText" class="ms-2"></span>
              </div>
            </div>
            <br/><br/>
            <hr/>
            <br/><br/>
            <div class="mb-3">
              <label for="match_urls" class="form-label">üîç Match URL Patterns</label>
              <input type="text" class="form-control" id="match_urls" 
                     placeholder="(youtube.com)|(wikipedia.org)|(reddit.com)|(news.ycombinator.com)|(x.com)|(github.com)">
              <div class="form-text">Regex of URLs to archive automatically whenever they are visited</div>
            </div>

            <div class="mb-3">
              <label for="exclude_urls" class="form-label">üö´ Exclude URL Patterns</label>
              <input type="text" class="form-control" id="exclude_urls" 
                     placeholder=":\/\/(mail.google.com)" value=":\/\/(mail.google.com)">
              <div class="form-text">Regex of URLs to never archive automatically</div>
            </div>
            <br/><br/>
            <div class="mb-3" style="background-color: #dfebfd; padding: 5px; border-radius: 6px;">
              <label for="testUrl" class="form-label">üîç Test the patterns and try adding a URL</label><span class="status-indicator mt-2" id="urlStatus" style="display:none;"></span>
              <div class="input-group">
                <input type="url" class="form-control" id="testUrl" 
                       placeholder="Enter a URL to test against patterns">
                <button type="button" id="testAdding" class="btn btn-outline-secondary" style="background-color: #dfebfd;">
                  TEST ADDING
                  <span class="status-indicator" id="addingStatus"></span>
                </button>
              </div>
              <div class="form-text">
                <span id="urlStatusText" class="ms-2"></span>
                <span id="addingStatusText" class="ms-2"></span>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Personas Tab -->
    <div class="tab-pane fade" id="personas" role="tabpanel">
      <div class="row mt-4">
        <div class="col">
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
          <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        </div>
      </div>
    </div>

    <!-- Import Tab -->
    <div class="tab-pane fade" id="import" role="tabpanel">
      <div class="row mt-4">
        <div class="col-md-12">
          <ul class="nav nav-pills mb-4" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" id="history-tab" data-bs-toggle="pill" href="#history" role="tab">Chrome History</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="bookmarks-tab" data-bs-toggle="pill" href="#bookmarks" role="tab">Chrome Bookmarks</a>
            </li>
          </ul>

          <div class="tab-content">
            <!-- History Import -->
            <div class="tab-pane fade show active" id="history" role="tabpanel">
              <div class="row mb-4">
                <div class="col-md-6">
                  <div class="input-group">
                    <span class="input-group-text">From</span>
                    <input type="date" class="form-control" id="historyStartDate">
                    <span class="input-group-text">To</span>
                    <input type="date" class="form-control" id="historyEndDate">
                    <button class="btn btn-primary" id="loadHistory">Load History</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Bookmarks Import -->
            <div class="tab-pane fade" id="bookmarks" role="tabpanel">
              <div class="row mb-4">
                <div class="col-md-6">
                  <button class="btn btn-primary" id="loadBookmarks">Load Bookmarks</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Common Import UI -->
          <div class="card">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <div class="input-group" style="max-width: 400px;">
                  <input type="search" class="form-control" id="importFilter" placeholder="Filter URLs and titles...">
                  <div class="input-group-text">
                    <input class="form-check-input mt-0" type="checkbox" id="showNewOnly">
                    <label class="form-check-label ms-2" for="showNewOnly">Show new only</label>
                  </div>
                </div>
                <div>
                  <span class="me-3">Selected: <span id="selectedCount">0</span></span>
                  <button class="btn btn-outline-secondary" id="selectAll">Select All</button>
                  <button class="btn btn-outline-secondary" id="deselectAll">Deselect All</button>
                </div>
              </div>

              <div class="table-responsive">
                <table class="table" id="importTable">
                  <thead>
                    <tr>
                      <th style="width: 40px;"><input type="checkbox" id="selectAllHeader"></th>
                      <th>URL</th>
                      <th>Title</th>
                      <th>Timestamp</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>

              <div class="mt-3">
                <div class="input-group" style="max-width: 400px;">
                  <span class="input-group-text">Tags</span>
                  <input type="text" class="form-control" id="importTags" placeholder="Add tags (comma separated)">
                  <button class="btn btn-primary" id="importSelected">Import Selected</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="bootstrap.bundle.min.js"></script>
  <script src="options.js"></script>
</body>
</html>
